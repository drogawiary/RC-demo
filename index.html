<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Różaniec — interaktywnie</title>

<!-- Tryb nocny na stałe -->
<meta name="color-scheme" content="dark">
<meta name="theme-color" content="#0e1633">

<style>
*{box-sizing:border-box;-webkit-text-size-adjust:100%}
html,body{margin:0;padding:0}
body{font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;color:var(--text);background:var(--bg);background-image:linear-gradient(180deg,var(--bg),rgba(255,255,255,0))}
:root{--bg:#0e1633;--panel:#161f3f;--panel-2:#1d2754;--text:#e8edff;--muted:#a7baf0;--accent:#5c82ff;--accent-2:#7faaff;--ring:#6ea8ff33;--soft:#202c5a}
.wrap{max-width:900px;margin:0 auto;padding:16px;background:linear-gradient(180deg,var(--panel),var(--panel-2));border-radius:20px;box-shadow:0 0 20px #0003}
header.book{
  background: linear-gradient(145deg,#0b3d91,#1565c0,#1e88e5);
  color: #fff;
  text-align: center;
  padding: 32px 20px;
  border-radius: 20px 20px 0 0;
  font-size: clamp(28px, 5vw, 40px);
  font-family: 'Playfair Display', serif;
  text-shadow: 0 0 8px #fff, 0 0 16px #a8c8ff;
  box-shadow: inset 0 0 10px #ffffff22, 0 2px 8px #0002;
  font-weight: 800;
}
header.book+.topbar{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin-top:8px;align-items:center}
.topbar{background:linear-gradient(180deg,#131833 0%,#0a0d1e 100%);border-radius:14px;padding:12px 16px;box-shadow:0 0 10px #4f7fff55}
.btnlink{border:1px solid var(--ring);background:var(--panel);padding:6px 10px;border-radius:10px;cursor:pointer;font-weight:700;color:var(--text)}
.panel{margin-top:12px;background:var(--panel);border:1px solid var(--ring);border-radius:14px;padding:14px}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{background:var(--panel-2);border:1px solid var(--ring);border-radius:10px;padding:8px 10px;cursor:pointer;font-weight:700;color:var(--text)}
.chip.active{outline:2px solid var(--accent-2);background:var(--soft)}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.space{flex:1}
.bigbtn{font-size:16px;font-weight:800;letter-spacing:.2px;background:var(--panel);border:1px solid var(--ring);border-radius:12px;padding:10px 14px;cursor:pointer;color:var(--text);transition:box-shadow .25s, transform .15s}
.bigbtn.active{box-shadow:0 0 0 3px #4f7fff33,0 0 18px 2px var(--accent-2);transform:scale(1.02)}
.bigbtn.primary{background:var(--accent);color:#fff;border-color:transparent}
.hide{display:none!important}
footer{margin:14px 0 6px;color:var(--muted);text-align:center}
.hint{display:block;margin-top:10px;font-size:13px;color:var(--muted);font-style:italic;text-align:center}
.progress{height:10px;background:var(--panel-2);border:1px solid var(--ring);border-radius:999px;overflow:hidden;margin:10px 0 8px}
.progress>div{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width .3s}
</style>
</head>
<body>
<div class="wrap">
  <header class="book">Różaniec</header>
  <div class="topbar">
    <button id="applyToday" class="btnlink" type="button">Ustaw dzisiejszą część</button>
    <button id="startBtn" class="bigbtn primary" type="button">Start</button>
  </div>

  <!-- Start -->
  <div id="startPanel" class="panel" role="region" aria-label="Wybór części różańca">
    <div class="row" style="margin-top:8px">
      <div class="chips" id="chips" role="tablist" aria-label="Części różańca">
        <div class="chip" data-part="radosne" role="tab" tabindex="0">Tajemnice radosne (pon/sob)</div>
        <div class="chip" data-part="bolesne" role="tab" tabindex="0">Tajemnice bolesne (wt/pt)</div>
        <div class="chip" data-part="swiatla" role="tab" tabindex="0">Tajemnice światła (czw)</div>
        <div class="chip" data-part="chwalebne" role="tab" tabindex="0">Tajemnice chwalebne (śr/nd)</div>
      </div>
    </div>
    <div class="row" style="margin-top:10px">
      <button id="introBtn" class="bigbtn" type="button">Wprowadzenie</button>
      <button id="endBtn" class="bigbtn" type="button">Zakończenie</button>
    </div>
  </div>

  <!-- Czytanie -->
  <div id="readPanel" class="panel hide" role="region" aria-live="polite" aria-label="Treść rozważań">
    <div class="progress"><div id="bar"></div></div>
    <div class="content" style="background:var(--panel-2);border:1px solid var(--ring);border-radius:14px;padding:14px;min-height:210px">
      <h3 id="stepTitle" style="margin:0 0 6px;font-size:18px">Tytuł</h3>
      <div id="stepBody" class="muted"></div>
    </div>
    <div class="row" style="margin-top:10px">
      <button id="prevBtn" class="bigbtn" type="button">⟵ Wstecz</button>
      <button id="nextBtn" class="bigbtn primary" type="button">Dalej ⟶</button>
      <button id="finishBtn" class="bigbtn hide" type="button">Zakończ część</button>
    </div>
  </div>

  <footer>
    Różaniec — cztery części. ✝️ © 2025 
    <a href="https://drogawiary.github.io/" style="color:inherit;text-decoration:none;font-weight:600;">
      drogawiary@wp.pl
    </a>
  </footer>
</div>

<script>
// Stały tryb nocny
document.documentElement.classList.add('dark');

(function(){
  // ===== Mapy i stałe =====
  const DAY_TO_PART={0:"chwalebne",1:"radosne",2:"bolesne",3:"chwalebne",4:"swiatla",5:"bolesne",6:"radosne"};
  const PART_NAME={radosne:"Tajemnice Radosne",bolesne:"Tajemnice Bolesne",swiatla:"Tajemnice Światła",chwalebne:"Tajemnice Chwalebne"};
  const PARTS=["radosne","bolesne","swiatla","chwalebne"];
  const S={ step:"rozaniec:step:", done:"rozaniec:done:", lastDate:"rozaniec:lastDate", lastPart:"rozaniec:lastPart" };

  // ===== Narzędzia czasu/pamięci =====
  function warsawDate(){ return new Intl.DateTimeFormat('en-CA',{timeZone:'Europe/Warsaw',year:'numeric',month:'2-digit',day:'2-digit'}).format(new Date()); }
  function todays(){ const label=new Intl.DateTimeFormat('pl-PL',{weekday:'long',timeZone:'Europe/Warsaw'}).format(new Date()); const m={"niedziela":0,"poniedziałek":1,"wtorek":2,"środa":3,"czwartek":4,"piątek":5,"sobota":6}; const d=m[label]??0; return {label,dow:d,part:DAY_TO_PART[d]}; }
  function keyStep(p){return S.step+p}
  function keyDone(p){return S.done+p}
  function savedStep(p){ const v=parseInt(localStorage.getItem(keyStep(p)),10); return Number.isFinite(v)? Math.min(Math.max(v,0), totalSteps()-1) : 0; }
  function isDone(p){ return localStorage.getItem(keyDone(p))==="1" }
  function setDone(p,val){ if(val){ localStorage.setItem(keyDone(p),"1"); } else { localStorage.removeItem(keyDone(p)); } }
  function saveStep(p,v){ localStorage.setItem(keyStep(p), String(v)); }
  function rememberPart(p){ if(p) localStorage.setItem(S.lastPart,p); }
  function resetIfNewDay(){ const today=warsawDate(); const last=localStorage.getItem(S.lastDate); if(last && last!==today){ PARTS.forEach(p=>{ localStorage.removeItem(keyStep(p)); localStorage.removeItem(keyDone(p)); }); } localStorage.setItem(S.lastDate,today); }
  function scheduleMidnightReset(){ const now=new Date(); const parts=new Intl.DateTimeFormat('en-CA',{timeZone:'Europe/Warsaw',year:'numeric',month:'2-digit',day:'2-digit'}).formatToParts(now); const y=+parts.find(p=>p.type==='year').value, m=+parts.find(p=>p.type==='month').value, d=+parts.find(p=>p.type==='day').value; const next=new Date(Date.UTC(y,m-1,d+1,0,0,0)); const ms=next-now; setTimeout(()=>{ resetIfNewDay(); }, Math.max(1000, ms)); }

  // ===== Treści =====
  const WSTEP_HTML=`<p><strong>✝️ Znak krzyża</strong><br/>W imię Ojca i Syna, i Ducha Świętego. Amen.</p><p><strong>Ojcze nasz</strong></p><p><strong>3× Zdrowaś Maryjo</strong> (o wiarę, nadzieję i miłość)</p><p><strong>Wierzę w Boga</strong> (Skład Apostolski)</p>`;
  const HINT='<span class="hint">Odmów: Ojcze nasz • 10× Zdrowaś Maryjo</span>';
  const CONTENT={
    radosne:{name:PART_NAME.radosne,intro:{title:"Modlitwy wstępne",body:WSTEP_HTML},items:[
      {title:"I – Zwiastowanie",body:"Maryja nie planowała cudu — słuchała. Uczy zgody na Boży plan.",hint:true},
      {title:"II – Nawiedzenie",body:"Radość dojrzewa w drodze do drugiego człowieka — w służbie.",hint:true},
      {title:"III – Narodzenie",body:"Bóg rodzi się w miejscach, które świat omija.",hint:true},
      {title:"IV – Ofiarowanie",body:"Miłość nie zatrzymuje — oddaje z ufnością.",hint:true},
      {title:"V – Odnalezienie",body:"Gubimy Jezusa w pośpiechu, On czeka w domu Ojca.",hint:true}
    ],outro:{title:"Ukończyłeś dzisiaj tę część różańca",body:"Możesz wrócić i wybrać inną część."}},
    bolesne:{name:PART_NAME.bolesne,intro:{title:"Modlitwy wstępne",body:WSTEP_HTML},items:[
      {title:"I – Ogrójec",body:"Nie moja, lecz Twoja wola, Panie.",hint:true},
      {title:"II – Biczowanie",body:"Każdy grzech to rana zadana Jezusowi.",hint:true},
      {title:"III – Cierniem ukoronowanie",body:"Pokorna wierność pośród szyderstwa.",hint:true},
      {title:"IV – Dźwiganie krzyża",body:"Wierność w trudnościach rodzi sens.",hint:true},
      {title:"V – Ukrzyżowanie",body:"„Ojcze, przebacz im”.",hint:true}
    ],outro:{title:"Ukończyłeś dzisiaj tę część różańca",body:"Możesz wrócić i wybrać inną część."}},
    swiatla:{name:PART_NAME.swiatla,intro:{title:"Modlitwy wstępne",body:WSTEP_HTML},items:[
      {title:"I – Chrzest w Jordanie",body:"Chrzest to tożsamość — żyj nią.",hint:true},
      {title:"II – Cud w Kanie",body:"„Zróbcie wszystko, cokolwiek wam powie”.",hint:true},
      {title:"III – Głoszenie Królestwa",body:"Słowo budzi sumienie — nawrócenie to prawda.",hint:true},
      {title:"IV – Przemienienie",body:"Światło z Taboru jest po to, by zejść do ludzi.",hint:true},
      {title:"V – Eucharystia",body:"Żyj Eucharystią na co dzień.",hint:true}
    ],outro:{title:"Ukończyłeś dzisiaj tę część różańca",body:"Możesz wrócić i wybrać inną część."}},
    chwalebne:{name:PART_NAME.chwalebne,intro:{title:"Modlitwy wstępne",body:WSTEP_HTML},items:[
      {title:"I – Zmartwychwstanie",body:"Nadzieja silniejsza niż grób.",hint:true},
      {title:"II – Wniebowstąpienie",body:"Cel jest wyżej — w niebie.",hint:true},
      {title:"III – Zesłanie Ducha Świętego",body:"Odwaga, prawda i pokój.",hint:true},
      {title:"IV – Wniebowzięcie Maryi",body:"Wierność prowadzi do chwały.",hint:true},
      {title:"V – Ukoronowanie Maryi",body:"Wielkość to służba.",hint:true}
    ],outro:{title:"Ukończyłeś dzisiaj tę część różańca",body:"Możesz wrócić i wybrać inną część."}}
  };

  // ===== Elementy UI =====
  const qs=s=>document.querySelector(s);
  const chips=qs('#chips');
  const applyToday=qs('#applyToday');
  const introBtn=qs('#introBtn');
  const endBtn=qs('#endBtn');
  const startBtn=qs('#startBtn');
  const startBtn2=qs('#startBtn2');
  const startPanel=qs('#startPanel');
  const readPanel=qs('#readPanel');
  const stepTitle=qs('#stepTitle');
  const stepBody=qs('#stepBody');
  const bar=qs('#bar');
  const prevBtn=qs('#prevBtn');
  const nextBtn=qs('#nextBtn');
  const finishBtn=qs('#finishBtn');

  // ===== Stan =====
  let currentPart=null; // nazwa części
  let step=0;           // indeks kroku 0..6
  let introMode=false;  // tryb Wprowadzenie
  let endMode=false;    // tryb Dziękczynienie

  // ===== Dzienna pamięć =====
  resetIfNewDay();
  scheduleMidnightReset();

  // ===== Render =====
  function totalSteps(){return 7}
  function showStart(){startPanel.classList.remove('hide');readPanel.classList.add('hide');introBtn.classList.remove('active');endBtn.classList.remove('active');}
  function showRead(){readPanel.classList.remove('hide');startPanel.classList.add('hide')}

  function renderStep(){
    if(introMode){
      stepTitle.textContent='Wprowadzenie';
      stepBody.innerHTML = `
<p><strong>Dlaczego bywa tak ciężko?</strong> Wielu świętych mówiło, że właśnie dlatego różaniec bywa trudny:
bo diabeł wie, jak wielką moc ma ta modlitwa. Wie, że jedno „Zdrowaś” może ocalić duszę,
że różaniec w rękach dziecka jest groźniejszy dla piekła niż największa armia.
Dlatego odciąga nas rozproszeniem, znużeniem, myślą, że to „nudne” albo „niepotrzebne”.</p>

<p>Gdy trudno ci zacząć, zatrzymaj się na chwilę i pomyśl o słowach modlitwy „Zdrowaś Maryjo”.
Spróbuj <strong>przytulić się sercem do Maryi</strong> – jak dziecko do swojej Matki.
Ona rozumie wszystko: twoje zmęczenie, rozproszenia, lęki i brak siły.
Chce tylko jednego – byś pozwolił Jej poprowadzić cię do Jezusa, jak najlepsza z matek prowadzi dziecko za rękę.</p>

<p>Z czułością wypowiadasz słowa, które <strong>Anioł Gabriel</strong> przyniósł do Niej z orędziem nieba:
<em>„Zdrowaś Maryjo, łaski pełna, Pan z Tobą.”</em>
To były najważniejsze słowa w Jej życiu – zwiastowały, że zostanie Matką samego Boga.
A potem dołączasz do głosu <strong>świętej Elżbiety</strong>, która z zachwytem i wiarą zawołała:
<em>„Błogosławionaś Ty między niewiastami i błogosławiony owoc żywota Twojego, Jezus.”</em></p>

<p>Kiedy więc mówisz „Zdrowaś Maryjo”, <strong>nie jesteś sam</strong>.
Maryja, Elżbieta i Anioł są przy tobie – naprawdę.
To nie recytacja, lecz <strong>rozmowa z Matką</strong>, która słucha z miłością i niesie twoje słowa do swojego Syna.
W tej modlitwie nie tylko wspominasz, ale <strong>uczestniczysz w tajemnicy spotkania Boga z człowiekiem</strong>.</p>

<p>
  Postaraj się odmawiać różaniec nie w pośpiechu, lecz ze zrozumieniem.
  Bo gdy modlisz się tylko po to, by „zdążyć” lub „zaliczyć” modlitwę —
  pomyśl, czy Maryi nie jest wtedy smutno?
</p>

<p>Maryja powtarzała to we wszystkich miejscach swoich objawień:
<strong>„Odmawiajcie codziennie różaniec.”</strong></p>

<p><em>Jak powiedziała s. Fernanda z Fatimy:</em><br>
<strong>„Różaniec jest jak mleko dla dziecka – pierwszy pokarm dla duszy.
Gdy zaczynasz go pić, zaczynasz rosnąć duchowo, a Maryja bierze cię za rękę i prowadzi do Jezusa.”</strong></p>

<hr style="margin:10px 0;opacity:0.5;">

<p>Z modlitwy Kościoła, z objawień i świadectw świętych wyłania się cicha obietnica:
<strong>wytrwały różaniec przynosi wielkie łaski.</strong></p>

<ul>
  <li>Szczególna opieka w życiu i przy śmierci.</li>
  <li>Nawrócenie największych grzeszników — nawet najtwardsze serce może się skruszyć.</li>
  <li>Ochrona przed złem — każde „Zdrowaś Maryjo” to cios w szatana i tarcza dla duszy.</li>
  <li>Pokój w rodzinach.</li>
  <li>Uzdrowienia duszy i ciała — świadectwa z Lourdes, Fatimy, Gietrzwałdu.</li>
  <li>Wysłuchanie próśb zgodnie z wolą Bożą.</li>
  <li>Pomoc w trudnościach — „Odmawiajcie różaniec, a otrzymacie łaski potrzebne w życiu.”</li>
  <li>Przygotowanie na trudne czasy — kto trzyma się różańca, nie zginie.</li>
</ul>

<hr style="margin:10px 0;opacity:0.5;">
<p style="margin-bottom:6px"><strong>Modlitwy wstępne (gdy chcesz rozpocząć część):</strong></p>
<p><strong>✝️ Znak krzyża</strong><br/>W imię Ojca i Syna, i Ducha Świętego. Amen.</p>
<p><strong>Ojcze nasz</strong></p>
<p><strong>3× Zdrowaś Maryjo</strong> (o wiarę, nadzieję i miłość)</p>
<p><strong>Wierzę w Boga</strong> (Skład Apostolski)</p>`;
      nextBtn.classList.add('hide');
      finishBtn.classList.add('hide');
      if(bar) bar.style.width='0%';
      return;
    }
    if(endMode){
      stepTitle.textContent='Dziękczynienie';
      stepBody.innerHTML=`<p><em>Dziękujemy za wspólną modlitwę różańcową.</em></p>`;
      nextBtn.classList.add('hide');
      finishBtn.classList.add('hide');
      if(bar) bar.style.width='100%';
      return;
    }

    let d=CONTENT[currentPart];
    if(!d){ currentPart='radosne'; d=CONTENT[currentPart]; }

    const max=totalSteps();
    let title,body;
    if(step===0){ title=d.intro.title; body=d.intro.body; }
    else if(step===max-1){ title=d.outro.title; body=d.outro.body; }
    else { const it=d.items[step-1]; title=it.title; body=it.body + (it.hint? ' '+HINT : ''); }

    stepTitle.textContent=title;
    stepBody.innerHTML=`<p style="margin:0;line-height:1.6">${body}</p>`;

    // zapis postępu + pasek
    saveStep(currentPart, step);
    if(bar){ const pct=Math.round((step/(max-1))*100); bar.style.width=pct+'%'; }

    nextBtn.classList.toggle('hide', step===max-1);
    finishBtn.classList.toggle('hide', step!==max-1);
  }

  // ===== Zdarzenia =====
  function setActiveChip(){ document.querySelectorAll('.chip').forEach(x=>x.classList.toggle('active', x.dataset.part===currentPart)); }

  chips.addEventListener('click',e=>{ const c=e.target.closest('.chip'); if(!c) return; currentPart=c.dataset.part; rememberPart(currentPart); step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart); setActiveChip(); });
  chips.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){ const c=e.target.closest('.chip'); if(!c) return; currentPart=c.dataset.part; rememberPart(currentPart); step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart); setActiveChip(); e.preventDefault(); }});

  applyToday.addEventListener('click',()=>{
    const t = todays();
    currentPart = t.part;
    rememberPart(currentPart);
    step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart);
    setActiveChip();
    introMode = false;
    endMode = false;
    showStart();
  });

  function startFlow(){
    introMode=false; endMode=false; introBtn.classList.remove('active'); endBtn.classList.remove('active');
    if(!currentPart){ const last=localStorage.getItem('rozaniec:lastPart'); if(last && PARTS.includes(last)) currentPart=last; else currentPart=todays().part; }
    step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart);
    rememberPart(currentPart);
    showRead();
    renderStep();
  }

  startBtn.addEventListener('click', startFlow);
  if(startBtn2) startBtn2.addEventListener('click', startFlow);

  introBtn.addEventListener('click',()=>{ introMode=true; endMode=false; introBtn.classList.add('active'); endBtn.classList.remove('active'); showRead(); renderStep(); });
  endBtn.addEventListener('click',()=>{ endMode=true; introMode=false; endBtn.classList.add('active'); introBtn.classList.remove('active'); showRead(); renderStep(); });

  prevBtn.addEventListener('click',()=>{ if(introMode||endMode){ introMode=false; endMode=false; showStart(); return; } if(step===0){ showStart(); return; } step=Math.max(0,step-1); renderStep(); });
  nextBtn.addEventListener('click',()=>{ step=Math.min(totalSteps()-1,step+1); renderStep(); });
  finishBtn.addEventListener('click',()=>{ setDone(currentPart,true); step=totalSteps()-1; saveStep(currentPart, step); rememberPart(currentPart); showStart(); setActiveChip(); });

  // ===== Inicjalizacja =====
  document.documentElement.classList.add('dark');
  const last=localStorage.getItem('rozaniec:lastPart');
  currentPart = PARTS.includes(last)? last : todays().part;
  step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart);
  setActiveChip();

  // Mini testy
  try{ console.assert(totalSteps()===7,'totalSteps==7'); }catch(e){ console.warn('Test:', e); }
})();
</script>
</body>
</html>
