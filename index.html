<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RÃ³Å¼aniec â€” interaktywnie</title>

<!-- StaÅ‚y tryb jasny, Å‚agodny styl jak w Droga Wiary -->
<meta name="color-scheme" content="light">
<meta name="theme-color" content="#1b2a49">

<style>
*{box-sizing:border-box;-webkit-text-size-adjust:100%}
html,body{margin:0;padding:0}
body{font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;color:var(--text);background:var(--bg)}
:root{--bg:#1b2a49;--panel:#22355c;--panel-2:#1d2e50;--text:#e7ecf6;--muted:#aab3c6;--accent:#4a8cff;--accent-2:#7aa8ff;--ring:#6ea8ff33;--soft:#223b6d}
.wrap{max-width:900px;margin:0 auto;padding:16px;background:linear-gradient(180deg,var(--panel),var(--panel-2));border-radius:20px;box-shadow:0 0 20px #0003}
header.book{background:linear-gradient(145deg,#0b3d91,#1565c0,#1e88e5);color:#fff;text-align:center;padding:32px 20px;border-radius:20px 20px 0 0;font-size:clamp(28px,5vw,40px);font-family:'Playfair Display',serif;text-shadow:0 0 8px #fff,0 0 16px #a8c8ff;box-shadow:inset 0 0 10px #ffffff22,0 2px 8px #0002;font-weight:800}
.topbar{background:linear-gradient(180deg,#22355c 0%,#1b2a49 100%);border-radius:14px;padding:12px 16px;box-shadow:0 0 10px #4f7fff55;display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin-top:8px;align-items:center}
.btnlink{border:1px solid var(--ring);background:var(--panel);padding:8px 14px;border-radius:10px;cursor:pointer;font-weight:700;color:var(--text)}
.bigbtn{font-size:16px;font-weight:800;letter-spacing:.2px;background:var(--panel);border:1px solid var(--ring);border-radius:12px;padding:10px 14px;cursor:pointer;color:var(--text);transition:box-shadow .25s, transform .15s}
.bigbtn.primary{background:var(--accent);color:#fff;border-color:transparent}
.bigbtn.active{box-shadow:0 0 0 3px #4f7fff33,0 0 18px 2px var(--accent-2);transform:scale(1.02)}
.panel{margin-top:12px;background:var(--panel);border:1px solid var(--ring);border-radius:14px;padding:14px}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{background:var(--panel-2);border:1px solid var(--ring);border-radius:10px;padding:8px 10px;cursor:pointer;font-weight:700;color:var(--text)}
.chip.active{outline:2px solid var(--accent-2);background:var(--soft)}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.space{flex:1}
.hide{display:none!important}
footer{margin:16px 0 0;background:var(--panel);border:1px solid var(--ring);border-radius:14px;color:var(--text);text-align:center;padding:16px;box-shadow:0 6px 16px #0003}
footer .fmuted{display:block;color:var(--muted);font-size:13px;margin-top:4px}
footer a{color:var(--text);text-decoration:none;font-weight:700}
footer a:hover{color:var(--accent-2)}
.hint{display:block;margin-top:10px;font-size:13px;color:var(--muted);font-style:italic;text-align:center}
.progress{height:10px;background:var(--panel-2);border:1px solid var(--ring);border-radius:999px;overflow:hidden;margin:10px 0 8px}
.progress>div{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width .3s}
.content{background:var(--panel-2);border:1px solid var(--ring);border-radius:14px;padding:14px;min-height:210px;max-height:70vh;overflow-y:auto}
blockquote{margin:0 0 8px;padding:8px 12px;border-left:3px solid var(--accent-2);background:#ffffff10;border-radius:8px}
.muted { color: var(--muted); }

</style>
</head>
<body>
<div class="wrap">
  <header class="book">RÃ³Å¼aniec</header>
  <div class="topbar">
    <button id="applyToday" class="btnlink" type="button">Ustaw dzisiejszÄ… czÄ™Å›Ä‡</button>
    <button id="startBtn" class="bigbtn primary" type="button">Start</button>
  </div>

  <div id="startPanel" class="panel">
    <div class="row" style="margin-top:8px">
      <div class="chips" id="chips">
        <div class="chip" data-part="radosne">Tajemnice radosne (pon/sob)</div>
        <div class="chip" data-part="bolesne">Tajemnice bolesne (wt/pt)</div>
        <div class="chip" data-part="swiatla">Tajemnice Å›wiatÅ‚a (czw)</div>
        <div class="chip" data-part="chwalebne">Tajemnice chwalebne (Å›r/nd)</div>
      </div>
    </div>
    <div class="row" style="margin-top:10px">
  <button id="introBtn" class="bigbtn" type="button">Wprowadzenie</button>
  <button id="promisesBtn" class="bigbtn" type="button">Obietnice Maryi</button>
  <button id="endBtn" class="bigbtn" type="button">DziÄ™kczynienie</button>
</div>

  </div>

  <div id="readPanel" class="panel hide">
    <div class="progress"><div id="bar"></div></div>
    <div class="content">
      <h3 id="stepTitle" style="margin:0 0 6px;font-size:18px">TytuÅ‚</h3>
      <div id="stepBody" class="muted"></div>
    </div>
    <div class="row" style="margin-top:10px">
      <button id="prevBtn" class="bigbtn" type="button">âŸµ Wstecz</button>
      <button id="nextBtn" class="bigbtn primary" type="button">Dalej âŸ¶</button>
      <button id="finishBtn" class="bigbtn hide" type="button">ZakoÅ„cz czÄ™Å›Ä‡</button>
    </div>
  </div>

  <footer>
    <div>â€Codzienny rÃ³Å¼aniecâ€ Â© 2025</div>
    <a href="https://drogawiary.github.io/" rel="noopener">Strona --> drogawiary@wp.pl</a>
  </footer>


</div>

<script>
(function(){
  // ===== Mapy i staÅ‚e =====
  const DAY_TO_PART={0:"chwalebne",1:"radosne",2:"bolesne",3:"chwalebne",4:"swiatla",5:"bolesne",6:"radosne"};
  const PART_NAME={radosne:"Tajemnice Radosne",bolesne:"Tajemnice Bolesne",swiatla:"Tajemnice ÅšwiatÅ‚a",chwalebne:"Tajemnice Chwalebne"};
  const PARTS=["radosne","bolesne","swiatla","chwalebne"];
  const S={ step:"rozaniec:step:", done:"rozaniec:done:", lastDate:"rozaniec:lastDate", lastPart:"rozaniec:lastPart" };

  // ===== NarzÄ™dzia czasu/pamiÄ™ci =====
  function warsawDate(){ return new Intl.DateTimeFormat('en-CA',{timeZone:'Europe/Warsaw',year:'numeric',month:'2-digit',day:'2-digit'}).format(new Date()); }
  function todays(){ const label=new Intl.DateTimeFormat('pl-PL',{weekday:'long',timeZone:'Europe/Warsaw'}).format(new Date()); const m={"niedziela":0,"poniedziaÅ‚ek":1,"wtorek":2,"Å›roda":3,"czwartek":4,"piÄ…tek":5,"sobota":6}; const d=m[label]??0; return {label,dow:d,part:DAY_TO_PART[d]}; }
  function keyStep(p){return S.step+p}
  function keyDone(p){return S.done+p}
  function savedStep(p){ const v=parseInt(localStorage.getItem(keyStep(p)),10); return Number.isFinite(v)? Math.min(Math.max(v,0), totalSteps()-1) : 0; }
  function isDone(p){ return localStorage.getItem(keyDone(p))==="1" }
  function setDone(p,val){ if(val){ localStorage.setItem(keyDone(p),"1"); } else { localStorage.removeItem(keyDone(p)); } }
  function saveStep(p,v){ localStorage.setItem(keyStep(p), String(v)); }
  function rememberPart(p){ if(p) localStorage.setItem(S.lastPart,p); }
  function resetIfNewDay(){ const today=warsawDate(); const last=localStorage.getItem(S.lastDate); if(last && last!==today){ PARTS.forEach(p=>{ localStorage.removeItem(keyStep(p)); localStorage.removeItem(keyDone(p)); }); } localStorage.setItem(S.lastDate,today); }
  function scheduleMidnightReset(){ const now=new Date(); const parts=new Intl.DateTimeFormat('en-CA',{timeZone:'Europe/Warsaw',year:'numeric',month:'2-digit',day:'2-digit'}).formatToParts(now); const y=+parts.find(p=>p.type==='year').value, m=+parts.find(p=>p.type==='month').value, d=+parts.find(p=>p.type==='day').value; const next=new Date(Date.UTC(y,m-1,d+1,0,0,0)); const ms=next-now; setTimeout(()=>{ resetIfNewDay(); }, Math.max(1000, ms)); }

  // ===== TreÅ›ci =====
  const WSTEP_HTML=`<p><strong>âœï¸ Znak krzyÅ¼a</strong><br/>W imiÄ™ Ojca i Syna, i Ducha ÅšwiÄ™tego. Amen.</p><p><strong>Ojcze nasz</strong></p><p><strong>3Ã— ZdrowaÅ› Maryjo</strong> (o wiarÄ™, nadziejÄ™ i miÅ‚oÅ›Ä‡)</p><p><strong>WierzÄ™ w Boga</strong> (SkÅ‚ad Apostolski)</p>`;
  const HINT='<span class="hint">OdmÃ³w: Ojcze nasz â€¢ 10Ã— ZdrowaÅ› Maryjo</span>';
  const CONTENT={
    radosne:{name:PART_NAME.radosne,intro:{title:"Modlitwy wstÄ™pne",body:WSTEP_HTML},items:[
      {title:"I â€“ Zwiastowanie",body:`<blockquote><strong>â€Oto ja sÅ‚uÅ¼ebnica PaÅ„ska, niech mi siÄ™ stanie wedÅ‚ug sÅ‚owa Twojego.â€</strong><br><em>(Åk 1,38)</em></blockquote>
<p>Maryja przyjmuje wolÄ™ Boga z ufnoÅ›ciÄ… â€” to najpiÄ™kniejsza chwila w Jej Å¼yciu, gdy SÅ‚owo staje siÄ™ ciaÅ‚em. A my: czy potrafimy powiedzieÄ‡ Bogu â€niech siÄ™ stanieâ€, nawet gdy nie wszystko rozumiemy?</p>`,hint:true},
      {title:"II â€“ Nawiedzenie",body:`<blockquote><strong>â€BÅ‚ogosÅ‚awiona jesteÅ›, ktÃ³raÅ› uwierzyÅ‚a, Å¼e speÅ‚niÄ… siÄ™ sÅ‚owa powiedziane Ci od Pana.â€</strong><br><em>(Åk 1,45)</em></blockquote>
<p>Maryja niesie Boga drugiemu czÅ‚owiekowi i budzi radoÅ›Ä‡ wiary w domu ElÅ¼biety. A my: czy potrafimy zanieÅ›Ä‡ EwangeliÄ™ w zwykÅ‚ej codziennoÅ›ci â€” sÅ‚owem, gestem, obecnoÅ›ciÄ…?</p>`,hint:true},
      {title:"III â€“ Narodzenie",body:`<blockquote><strong>â€PorodziÅ‚a swego pierworodnego Syna, owinÄ™Å‚a Go w pieluszki i poÅ‚oÅ¼yÅ‚a w Å¼Å‚obie.â€</strong><br><em>(Åk 2,7)</em></blockquote>
<p>BÃ³g przychodzi w prostocie i ubÃ³stwie, nie szuka paÅ‚acu â€” szuka serca. Czy w moim sercu jest dla Niego miejsce, gdy przychodzi po cichu?</p>`,hint:true},
      {title:"IV â€“ Ofiarowanie",body:`<blockquote><strong>â€Moje oczy ujrzaÅ‚y Twoje zbawienie, ktÃ³re przygotowaÅ‚eÅ› wobec wszystkich narodÃ³w.â€</strong><br><em>(Åk 2,30â€“31)</em></blockquote>
<p>Symeon rozpoznaje w DzieciÄ…tku Zbawiciela; Maryja uczy, Å¼e miÅ‚oÅ›Ä‡ potrafi oddaÄ‡ to, co najcenniejsze. Czy ja umiem ofiarowaÄ‡ Bogu moje plany i lÄ™ki?</p>`,hint:true},
      {title:"V â€“ Odnalezienie",body:`<blockquote><strong>â€CzemuÅ›cie Mnie szukali? Czy nie wiedzieliÅ›cie, Å¼e powinienem byÄ‡ w tym, co naleÅ¼y do mego Ojca?â€</strong><br><em>(Åk 2,49)</em></blockquote>
<p>Maryja i JÃ³zef odnajdujÄ… Jezusa w Å›wiÄ…tyni. A my â€” czy potrafimy odnaleÅºÄ‡ Go <strong>w naszych Å›wiÄ…tyniach</strong>: w Eucharystii, w ciszy modlitwy, we wspÃ³lnocie? Kto szuka z sercem, ten odnajdzie.</p>`,hint:true}
    ],outro:{title:"UkoÅ„czyÅ‚eÅ› dzisiaj tÄ™ czÄ™Å›Ä‡ rÃ³Å¼aÅ„ca",body:"MoÅ¼esz wrÃ³ciÄ‡ i wybraÄ‡ innÄ… czÄ™Å›Ä‡."}},

    bolesne:{name:PART_NAME.bolesne,intro:{title:"Modlitwy wstÄ™pne",body:WSTEP_HTML},items:[
      {title:"I â€“ Modlitwa Jezusa w OgrÃ³jcu",body:`<blockquote><strong>â€Ojcze, jeÅ›li chcesz, zabierz ode Mnie ten kielich! Jednak nie moja wola, lecz Twoja niech siÄ™ stanie.â€</strong><br><em>(Åk 22,42)</em></blockquote><p>Jezus modli siÄ™ w samotnoÅ›ci, zmagajÄ…c z lÄ™kiem i bÃ³lem. Nie ucieka â€” ufa Ojcu. Czy ja w chwilach trudu teÅ¼ potrafiÄ™ powiedzieÄ‡: â€Nie moja, lecz Twoja wola, Panieâ€?</p>`,hint:true},
      {title:"II â€“ Biczowanie Pana Jezusa",body:`<blockquote><strong>â€Wtedy PiÅ‚at wziÄ…Å‚ Jezusa i kazaÅ‚ Go ubiczowaÄ‡.â€</strong><br><em>(J 19,1)</em></blockquote><p>KaÅ¼dy grzech rani Serce Jezusa. On przyjmuje cierpienie w milczeniu, z miÅ‚oÅ›ci do nas. Czy mam Å›wiadomoÅ›Ä‡, Å¼e moje sÅ‚aboÅ›ci teÅ¼ pozostawiajÄ… Å›lad na Jego ciele?</p>`,hint:true},
      {title:"III â€“ Cierniem ukoronowanie",body:`<blockquote><strong>â€A uplÃ³tÅ‚szy koronÄ™ z cierni, wÅ‚oÅ¼yli Mu jÄ… na gÅ‚owÄ™.â€</strong><br><em>(J 19,2)</em></blockquote><p>Ludzie szydzÄ…, a On milczy. Pokorna wiernoÅ›Ä‡ Jezusa w upokorzeniu uczy nas, Å¼e prawdziwa chwaÅ‚a rodzi siÄ™ z pokory. Czy potrafiÄ™ milczeÄ‡, gdy jestem niesprawiedliwie oceniany?</p>`,hint:true},
      {title:"IV â€“ DÅºwiganie krzyÅ¼a",body:`<blockquote><strong>â€A On sam dÅºwigaÅ‚ krzyÅ¼ na miejsce zwane CzaszkÄ….â€</strong><br><em>(J 19,17)</em></blockquote><p>Jezus niesie krzyÅ¼ aÅ¼ na GolgotÄ™ â€” krok po kroku, w milczeniu, z miÅ‚oÅ›ci. Na tej drodze spotyka cierpienie, ale teÅ¼ ludzkie serca, ktÃ³re pomagajÄ… Mu nieÅ›Ä‡ ciÄ™Å¼ar. Czy ja pomagam nieÅ›Ä‡ cudze krzyÅ¼e, czy tylko unikam wÅ‚asnych?</p>`,hint:true},
      {title:"V â€“ UkrzyÅ¼owanie i Å›mierÄ‡ Jezusa",body:`<blockquote><strong>â€Ojcze, przebacz im, bo nie wiedzÄ…, co czyniÄ….â€</strong><br><em>(Åk 23,34)</em></blockquote><p>Z krzyÅ¼a pÅ‚ynie przebaczenie â€” dla wszystkich, ktÃ³rzy raniÄ…. MiÅ‚oÅ›Ä‡ Jezusa nie zna granic, nawet w chwili Å›mierci. Czy ja potrafiÄ™ przebaczyÄ‡ tym, ktÃ³rzy mnie skrzywdzili?</p>`,hint:true}
    ],outro:{title:"UkoÅ„czyÅ‚eÅ› dzisiaj tÄ™ czÄ™Å›Ä‡ rÃ³Å¼aÅ„ca",body:"MoÅ¼esz wrÃ³ciÄ‡ i wybraÄ‡ innÄ… czÄ™Å›Ä‡."}},

    swiatla:{name:PART_NAME.swiatla,intro:{title:"Modlitwy wstÄ™pne",body:WSTEP_HTML},items:[
      {title:"I â€“ Chrzest Jezusa w Jordanie",body:`<blockquote><strong>â€TyÅ› jest mÃ³j Syn umiÅ‚owany, w Tobie mam upodobanie.â€</strong><br><em>(Åk 3,22)</em></blockquote><p>Jezus wchodzi do wody nie dlatego, Å¼e potrzebuje oczyszczenia, ale by uÅ›wiÄ™ciÄ‡ nasze Å¼ycie. Czy pamiÄ™tam o Å‚asce mojego chrztu â€“ o dniu, w ktÃ³rym BÃ³g nazwaÅ‚ mnie swoim dzieckiem?</p>`,hint:true},
      {title:"II â€“ Cud w Kanie Galilejskiej",body:`<blockquote><strong>â€ZrÃ³bcie wszystko, cokolwiek wam powie.â€</strong><br><em>(J 2,5)</em></blockquote><p>Maryja wskazuje na Jezusa â€“ to Ona pierwsza uczy zaufania. Czy sÅ‚ucham gÅ‚osu Boga w moim Å¼yciu, czy raczej chcÄ™, by to On sÅ‚uchaÅ‚ mnie?</p>`,hint:true},
      {title:"III â€“ GÅ‚oszenie KrÃ³lestwa BoÅ¼ego",body:`<blockquote><strong>â€Czas siÄ™ wypeÅ‚niÅ‚ i bliskie jest krÃ³lestwo BoÅ¼e. Nawracajcie siÄ™ i wierzcie w EwangeliÄ™.â€</strong><br><em>(Mk 1,15)</em></blockquote><p>Jezus przynosi DobrÄ… NowinÄ™ â€“ mÃ³wi o miÅ‚osierdziu, prawdzie i przebaczeniu. Czy pozwalam, by Jego sÅ‚owo naprawdÄ™ zmieniaÅ‚o moje Å¼ycie?</p>`,hint:true},
      {title:"IV â€“ Przemienienie na GÃ³rze Tabor",body:`<blockquote><strong>â€To jest mÃ³j Syn umiÅ‚owany, Jego sÅ‚uchajcie!â€</strong><br><em>(Mk 9,7)</em></blockquote><p>Uczniowie widzÄ… Jezusa w chwale â€“ na chwilÄ™ dotykajÄ… nieba. Czy potrafiÄ™ sÅ‚uchaÄ‡ Jezusa w ciszy serca, nie tylko wtedy, gdy dziejÄ… siÄ™ cuda?</p>`,hint:true},
      {title:"V â€“ Ustanowienie Eucharystii",body:`<blockquote><strong>â€To jest CiaÅ‚o moje, ktÃ³re za was bÄ™dzie wydane.â€</strong><br><em>(Åk 22,19)</em></blockquote><p>W Eucharystii Jezus daje siebie caÅ‚y. Czy rozumiem, Å¼e Komunia to nie symbol, ale prawdziwe spotkanie Boga z czÅ‚owiekiem?</p>`,hint:true}
    ],outro:{title:"UkoÅ„czyÅ‚eÅ› dzisiaj tÄ™ czÄ™Å›Ä‡ rÃ³Å¼aÅ„ca",body:"MoÅ¼esz wrÃ³ciÄ‡ i wybraÄ‡ innÄ… czÄ™Å›Ä‡."}},

    chwalebne:{name:PART_NAME.chwalebne,intro:{title:"Modlitwy wstÄ™pne",body:WSTEP_HTML},items:[
      {title:"I â€“ Zmartwychwstanie Jezusa",body:`<blockquote><strong>â€Dlaczego szukacie Å¼yjÄ…cego wÅ›rÃ³d umarÅ‚ych? Nie ma Go tu â€“ zmartwychwstaÅ‚.â€</strong><br><em>(Åk 24,5â€“6)</em></blockquote><p>Zmartwychwstanie to zwyciÄ™stwo miÅ‚oÅ›ci nad Å›mierciÄ…. Czy wierzÄ™, Å¼e BÃ³g moÅ¼e oÅ¼ywiÄ‡ to, co w moim Å¼yciu umarÅ‚o?</p>`,hint:true},
      {title:"II â€“ WniebowstÄ…pienie",body:`<blockquote><strong>â€A oto Ja jestem z wami przez wszystkie dni, aÅ¼ do skoÅ„czenia Å›wiata.â€</strong><br><em>(Mt 28,20)</em></blockquote><p>Jezus odchodzi do Ojca, ale nie zostawia nas samych. Czy wierzÄ™, Å¼e Jego obecnoÅ›Ä‡ jest bliÅ¼ej niÅ¼ myÅ›lÄ™?</p>`,hint:true},
      {title:"III â€“ ZesÅ‚anie Ducha ÅšwiÄ™tego",body:`<blockquote><strong>â€I wszyscy zostali napeÅ‚nieni Duchem ÅšwiÄ™tym.â€</strong><br><em>(Dz 2,4)</em></blockquote><p>Duch ÅšwiÄ™ty przemienia serca uczniÃ³w i daje im odwagÄ™. Czy modlÄ™ siÄ™ o Ducha ÅšwiÄ™tego w moim codziennym Å¼yciu?</p>`,hint:true},
      {title:"IV â€“ WniebowziÄ™cie NajÅ›wiÄ™tszej Maryi Panny",body:`<blockquote><strong>â€BÅ‚ogosÅ‚awiona jesteÅ›, Maryjo, bo uwierzyÅ‚aÅ›, Å¼e speÅ‚niÄ… siÄ™ sÅ‚owa powiedziane Ci od Pana.â€</strong><br><em>(Åk 1,45)</em></blockquote><p>Maryja zostaje wziÄ™ta do nieba â€“ to znak nadziei dla wszystkich wierzÄ…cych. Czy moje Å¼ycie prowadzi ku niebu?</p>`,hint:true},
      {title:"V â€“ Ukoronowanie Maryi na KrÃ³lowÄ… nieba i ziemi",body:`<blockquote><strong>â€Wielbi dusza moja Pana, bo wejrzaÅ‚ na uniÅ¼enie swojej sÅ‚uÅ¼ebnicy.â€</strong><br><em>(Åk 1,46â€“48)</em></blockquote><p>Maryja krÃ³luje nie z tronu, ale z serca peÅ‚nego pokory. Czy ja potrafiÄ™ sÅ‚uÅ¼yÄ‡, jak Ona â€“ z radoÅ›ciÄ… i bez oczekiwania chwaÅ‚y?</p>`,hint:true}
    ],outro:{title:"UkoÅ„czyÅ‚eÅ› dzisiaj tÄ™ czÄ™Å›Ä‡ rÃ³Å¼aÅ„ca",body:"MoÅ¼esz wrÃ³ciÄ‡ i wybraÄ‡ innÄ… czÄ™Å›Ä‡."}}
  };

  // ===== Elementy UI =====
  const qs=s=>document.querySelector(s);
  const chips=qs('#chips');
  const applyToday=qs('#applyToday');
  const introBtn=qs('#introBtn');
  const promisesBtn=qs('#promisesBtn');
  const endBtn=qs('#endBtn');
  const startBtn=qs('#startBtn');
  const startPanel=qs('#startPanel');
  const readPanel=qs('#readPanel');
  const stepTitle=qs('#stepTitle');
  const stepBody=qs('#stepBody');
  const bar=qs('#bar');
  const prevBtn=qs('#prevBtn');
  const nextBtn=qs('#nextBtn');
  const finishBtn=qs('#finishBtn');

  // ===== Stan =====
let currentPart=null;  // nazwa czÄ™Å›ci
let step=0;            // indeks kroku 0..6
let introMode=false;   // tryb Wprowadzenie
let promisesMode=false; // tryb Obietnice Maryi
let endMode=false;     // tryb DziÄ™kczynienie


  // ===== Dzienna pamiÄ™Ä‡ =====
  resetIfNewDay();
  scheduleMidnightReset();

  // ===== Render =====
  function totalSteps(){return 7}
function showStart(){
  startPanel.classList.remove('hide');
  readPanel.classList.add('hide');
  introBtn.classList.remove('active');
  promisesBtn.classList.remove('active');
  endBtn.classList.remove('active');
}
  function showRead(){readPanel.classList.remove('hide');startPanel.classList.add('hide')}

  function renderStep(){
    if(introMode){
      const t=todays();
      stepTitle.textContent='Wprowadzenie';
stepBody.innerHTML = `
<p><strong>Dlaczego bywa tak ciÄ™Å¼ko?</strong> Wielu Å›wiÄ™tych mÃ³wiÅ‚o, Å¼e wÅ‚aÅ›nie dlatego rÃ³Å¼aniec bywa trudny:
bo diabeÅ‚ wie, jak wielkÄ… moc ma ta modlitwa. Wie, Å¼e jedno â€ZdrowaÅ›â€ moÅ¼e ocaliÄ‡ duszÄ™,
Å¼e rÃ³Å¼aniec w rÄ™kach dziecka jest groÅºniejszy dla piekÅ‚a niÅ¼ najwiÄ™ksza armia.
Dlatego odciÄ…ga nas rozproszeniem, znuÅ¼eniem, myÅ›lÄ…, Å¼e to â€nudneâ€ albo â€niepotrzebneâ€.</p>

<p>Gdy trudno ci zaczÄ…Ä‡, zatrzymaj siÄ™ na chwilÄ™ i pomyÅ›l o sÅ‚owach modlitwy â€ZdrowaÅ› Maryjoâ€.
SprÃ³buj <strong>przytuliÄ‡ siÄ™ sercem do Maryi</strong> â€“ jak dziecko do swojej Matki.
Ona rozumie wszystko: twoje zmÄ™czenie, rozproszenia, lÄ™ki i brak siÅ‚y.
Chce tylko jednego â€“ byÅ› pozwoliÅ‚ Jej poprowadziÄ‡ ciÄ™ do Jezusa, jak najlepsza z matek prowadzi dziecko za rÄ™kÄ™.</p>

<p>Z czuÅ‚oÅ›ciÄ… wypowiadasz sÅ‚owa, ktÃ³re <strong>AnioÅ‚ Gabriel</strong> przyniÃ³sÅ‚ do Niej z orÄ™dziem nieba:
<em>â€ZdrowaÅ› Maryjo, Å‚aski peÅ‚na, Pan z TobÄ….â€</em>
To byÅ‚y najwaÅ¼niejsze sÅ‚owa w Jej Å¼yciu â€“ zwiastowaÅ‚y, Å¼e zostanie MatkÄ… samego Boga.
A potem doÅ‚Ä…czasz do gÅ‚osu <strong>Å›wiÄ™tej ElÅ¼biety</strong>, ktÃ³ra z zachwytem i wiarÄ… zawoÅ‚aÅ‚a:
<em>â€BÅ‚ogosÅ‚awionaÅ› Ty miÄ™dzy niewiastami i bÅ‚ogosÅ‚awiony owoc Å¼ywota Twojego, Jezus.â€</em></p>

<p>Kiedy wiÄ™c mÃ³wisz â€ZdrowaÅ› Maryjoâ€, <strong>nie jesteÅ› sam</strong>.
Maryja, ElÅ¼bieta i AnioÅ‚ sÄ… przy tobie â€“ naprawdÄ™.
To nie recytacja, lecz <strong>rozmowa z MatkÄ…</strong>, ktÃ³ra sÅ‚ucha z miÅ‚oÅ›ciÄ… i niesie twoje sÅ‚owa do swojego Syna.
W tej modlitwie nie tylko wspominasz, ale <strong>uczestniczysz w tajemnicy spotkania Boga z czÅ‚owiekiem</strong>.</p>

<p>
  Postaraj siÄ™ odmawiaÄ‡ rÃ³Å¼aniec nie w poÅ›piechu, lecz ze zrozumieniem.
  Bo gdy modlisz siÄ™ tylko po to, by â€zdÄ…Å¼yÄ‡â€ lub â€zaliczyÄ‡â€ modlitwÄ™ â€”
  pomyÅ›l, czy Maryi nie jest wtedy smutno?
</p>


<p>Maryja powtarzaÅ‚a to we wszystkich miejscach swoich objawieÅ„:
<strong>â€Odmawiajcie codziennie rÃ³Å¼aniec.â€</strong></p>

<p><em>Jak powiedziaÅ‚a s. Fernanda z Fatimy:</em><br>
<strong>â€RÃ³Å¼aniec jest jak mleko dla dziecka â€“ pierwszy pokarm dla duszy.
Gdy zaczynasz go piÄ‡, zaczynasz rosnÄ…Ä‡ duchowo, a Maryja bierze ciÄ™ za rÄ™kÄ™ i prowadzi do Jezusa.â€</strong></p>

<hr style="margin:10px 0;opacity:0.5;">

<p>Z modlitwy KoÅ›cioÅ‚a, z objawieÅ„ i Å›wiadectw Å›wiÄ™tych wyÅ‚ania siÄ™ cicha obietnica:
<strong>wytrwaÅ‚y rÃ³Å¼aniec przynosi wielkie Å‚aski.</strong></p>

<ul>
  <li>SzczegÃ³lna opieka w Å¼yciu i przy Å›mierci.</li>
  <li>NawrÃ³cenie najwiÄ™kszych grzesznikÃ³w â€” nawet najtwardsze serce moÅ¼e siÄ™ skruszyÄ‡.</li>
  <li>Ochrona przed zÅ‚em â€” kaÅ¼de â€ZdrowaÅ› Maryjoâ€ to cios w szatana i tarcza dla duszy.</li>
  <li>PokÃ³j w rodzinach.</li>
  <li>Uzdrowienia duszy i ciaÅ‚a â€” Å›wiadectwa z Lourdes, Fatimy, GietrzwaÅ‚du.</li>
  <li>WysÅ‚uchanie prÃ³Å›b zgodnie z wolÄ… BoÅ¼Ä….</li>
  <li>Pomoc w trudnoÅ›ciach â€” â€Odmawiajcie rÃ³Å¼aniec, a otrzymacie Å‚aski potrzebne w Å¼yciu.â€</li>
  <li>Przygotowanie na trudne czasy â€” kto trzyma siÄ™ rÃ³Å¼aÅ„ca, nie zginie.</li>
</ul>
`;

      nextBtn.classList.add('hide');
      finishBtn.classList.add('hide');
      if(bar) bar.style.width='0%';
      return;
    }

if (promisesMode) {
  stepTitle.textContent = 'Obietnice Maryi';
  stepBody.innerHTML = `
<p><strong>Obietnice Maryi dla wytrwaÅ‚ych w rÃ³Å¼aÅ„cu</strong></p>

<p>Z modlitwy KoÅ›cioÅ‚a, z przekazÃ³w objawieÅ„ oraz Å›wiadectw Å›wiÄ™tych i zwykÅ‚ych ludzi
wyÅ‚ania siÄ™ pewna, cicha obietnica Maryi:
<strong>wytrwaÅ‚y rÃ³Å¼aniec przynosi wielkie Å‚aski</strong>.</p>

<ul>
  <li><strong>SzczegÃ³lna opieka</strong> â€“ w Å¼yciu i przy Å›mierci.</li>
  <li><strong>NawrÃ³cenie najwiÄ™kszych grzesznikÃ³w</strong> â€“ wytrwaÅ‚a modlitwa kruszy najtwardsze serca.</li>
  <li><strong>Ochrona przed pokusami i zÅ‚em</strong> â€“ kaÅ¼de â€ZdrowaÅ›â€ jest ciosem w szatana i tarczÄ… dla duszy.</li>
  <li><strong>PokÃ³j w rodzinach</strong> â€“ wspÃ³lna modlitwa zbliÅ¼a serca i uczy przebaczenia.</li>
  <li><strong>Uzdrowienia duszy i ciaÅ‚a</strong> â€“ niezliczone Å›wiadectwa z sanktuariÃ³w, takich jak Lourdes, Fatima, GietrzwaÅ‚d.</li>
  <li><strong>WysÅ‚uchanie prÃ³Å›b</strong> â€“ zgodnie z wolÄ… BoÅ¼Ä… i dla zbawienia duszy.</li>
  <li><strong>Pomoc w trudnoÅ›ciach</strong> â€“ â€Odmawiajcie rÃ³Å¼aniec, a otrzymacie Å‚aski potrzebne w Å¼yciu.â€</li>
  <li><strong>Przygotowanie na trudne czasy</strong> â€“ kto trzyma siÄ™ rÃ³Å¼aÅ„ca, nie zginie.</li>
</ul>

<blockquote>
  <p><strong>â€Ja was nie opuszczÄ™. Wasza Matka.â€</strong></p>
  <p><strong>â€RÃ³Å¼aniec odmawiany z wiarÄ… i poboÅ¼noÅ›ciÄ… jest wielkim ratunkiem dla dusz
  i Å›rodkiem do zwyciÄ™stwa nad szatanem.â€</strong></p>
  <p><strong>â€Jedno ZdrowaÅ› Maryjo Å›wiadomie i uwaÅ¼nie odmÃ³wione ma wiÄ™kszÄ… wartoÅ›Ä‡
  niÅ¼ setki mechanicznie wypowiedzianych sÅ‚Ã³w.â€</strong><br>
  â€” Å›w. Ludwik Maria Grignion de Montfort</p>
  <p><strong>â€RÃ³Å¼aniec to modlitwa tych, ktÃ³rzy kochajÄ…, ale nie wiedzÄ…, jak mÃ³wiÄ‡.â€</strong><br>
  â€” Å›w. Jan PaweÅ‚ II</p>
  <p><strong>â€RÃ³Å¼aniec to Å‚aÅ„cuch, ktÃ³ry Å‚Ä…czy nas z Bogiem.â€</strong><br>
  â€” Å›w. Teresa z Lisieux</p>
  <p><strong>â€JeÅ›li chcesz nawrÃ³ciÄ‡ grzesznika, odmÃ³w za niego rÃ³Å¼aniec.â€</strong><br>
  â€” Å›w. Jan Maria Vianney</p>
  <p><strong>â€Gdy mÃ³wisz rÃ³Å¼aniec, Maryja jest tuÅ¼ obok ciebie.â€</strong><br>
  â€” Å›w. Alfons Maria Liguori</p>
</blockquote>

<hr style="margin:10px 0;opacity:0.5;">

<p><strong>ğŸŒ¹ Nowenna PompejaÅ„ska â€” â€Modlitwa nie do odparciaâ€</strong><br>
Bartolo Longo, 1879 r.</p>

<p>To 54 dni modlitwy bez przerwy: trzy nowenny bÅ‚agalne i trzy dziÄ™kczynne.
Åšwiadectwa mÃ³wiÄ… o szczegÃ³lnych Å‚askach:</p>

<ul>
  <li>uzdrowienia z chorÃ³b uznanych za nieuleczalne,</li>
  <li>uratowanie maÅ‚Å¼eÅ„stw i rodzin,</li>
  <li>uwolnienie od naÅ‚ogÃ³w,</li>
  <li>Å‚aska wiary dla osÃ³b niewierzÄ…cych,</li>
  <li>pokÃ³j serca w sytuacjach bez wyjÅ›cia.</li>
</ul>

<p>Wielu nazywa jÄ… <strong>â€modlitwÄ… nie do odparciaâ€</strong> â€“ Maryja odpowiada na niÄ… w sposÃ³b szczegÃ³lnie hojny.</p>

<hr style="margin:10px 0;opacity:0.5;">

<p><strong>ğŸŒ¹ 15 obietnic rÃ³Å¼aÅ„cowych â€” â€RÃ³Å¼aniec bÄ™dzie ocaleniem Å›wiata.â€</strong></p>

<p>Tradycja KoÅ›cioÅ‚a przypomina, Å¼e bÅ‚. Alan de la Roche (XV w.) odnowiÅ‚ praktykÄ™ rÃ³Å¼aÅ„ca
i przekazaÅ‚ 15 obietnic dla tych, ktÃ³rzy wiernie go odmawiajÄ….</p>

<p><em>â€Te obietnice nie sÄ… kontraktem. To odpowiedÅº MiÅ‚oÅ›ci na modlitwÄ™ serca.â€</em></p>

<ol>
  <li>Tym, ktÃ³rzy wiernie bÄ™dÄ… odmawiaÄ‡ mÃ³j RÃ³Å¼aniec, obiecujÄ™ szczegÃ³lnÄ… opiekÄ™ i wielkie Å‚aski.</li>
  <li>OtrzymajÄ… szczegÃ³lnÄ… ochronÄ™ oraz potÄ™Å¼nych orÄ™downikÃ³w w niebie.</li>
  <li>RÃ³Å¼aniec bÄ™dzie potÄ™Å¼nÄ… broniÄ… przeciw piekÅ‚u; zniszczy grzech, umniejszy winÄ™ i zwyciÄ™Å¼y herezje.</li>
  <li>Spowoduje rozkwit cnÃ³t i dobrych uczynkÃ³w; wyprosi wiele miÅ‚osierdzia dla dusz.</li>
  <li>Dusza, ktÃ³ra poleca siÄ™ mnie przez RÃ³Å¼aniec, nie zginie.</li>
  <li>Wierny rÃ³Å¼aÅ„cowi nie zostanie pokonany przez nieszczÄ™Å›cia.</li>
  <li>Sprawiedliwy wytrwa w Å‚asce, a grzesznik â€“ nawrÃ³ci siÄ™.</li>
  <li>MiÅ‚ujÄ…cy RÃ³Å¼aniec otrzymajÄ… w Å¼yciu i przy Å›mierci Å›wiatÅ‚o BoÅ¼e i peÅ‚niÄ™ Å‚aski.</li>
  <li>WybawiÄ™ z czyÅ›Ä‡ca tych, ktÃ³rzy odmawiali mÃ³j RÃ³Å¼aniec z miÅ‚oÅ›ciÄ….</li>
  <li>Wierni tej modlitwie osiÄ…gnÄ… wysoki stopieÅ„ chwaÅ‚y w niebie.</li>
  <li>Otrzymacie wszystko, o co prosicie przez RÃ³Å¼aniec, jeÅ›li jest to zgodne z wolÄ… mojego Syna.</li>
  <li>SzerzÄ…cym mÃ³j RÃ³Å¼aniec pomogÄ™ we wszystkich potrzebach.</li>
  <li>WpiszÄ™ odmawiajÄ…cych RÃ³Å¼aniec w moje Niepokalane Serce.</li>
  <li>OdmawiajÄ…cy RÃ³Å¼aniec sÄ… moimi umiÅ‚owanymi dzieÄ‡mi, a ja ich MatkÄ….</li>
  <li>RÃ³Å¼aniec jest znakiem zbawienia: kto go nosi i modli siÄ™ z wiarÄ…, bÄ™dzie bezpieczny w godzinie Å›mierci.</li>
</ol>

<p class="hint">Te obietnice sÄ… zaproszeniem do zaufania.  
Maryja nie obiecuje Å‚atwego Å¼ycia, ale to, Å¼e <strong>z rÃ³Å¼aÅ„cem nigdy nie bÄ™dziesz sam</strong>.</p>
`;

  nextBtn.classList.add('hide');
  finishBtn.classList.add('hide');
  if (bar) bar.style.width = '0%';
  return;
}

    
    if(endMode){
      stepTitle.textContent='DziÄ™kczynienie';
      stepBody.innerHTML=`
<p><em>DziÄ™kujÄ™ Ci, Maryjo, Å¼e pozwoliÅ‚aÅ› mi odkryÄ‡ moc tej modlitwy.</em></p>

<p><strong>â€RÃ³Å¼aniec odmawiany z wiarÄ… i poboÅ¼noÅ›ciÄ… jest ratunkiem dla duszy i zwyciÄ™stwem nad szatanem.â€</strong><br>
<strong>â€Jedno ZdrowaÅ› Maryjo Å›wiadomie i uwaÅ¼nie odmÃ³wione ma wiÄ™kszÄ… wartoÅ›Ä‡ niÅ¼ setki bezmyÅ›lnych sÅ‚Ã³w.â€</strong><br>
â€” Å›w. Ludwik Maria Grignion de Montfort</p>

<p><strong>â€RÃ³Å¼aniec to modlitwa tych, ktÃ³rzy kochajÄ…, ale nie wiedzÄ…, jak mÃ³wiÄ‡.â€</strong><br>
â€” Å›w. Jan PaweÅ‚ II</p>

<p><strong>â€RÃ³Å¼aniec to Å‚aÅ„cuch, ktÃ³ry Å‚Ä…czy nas z Bogiem.â€</strong><br>
â€” Å›w. Teresa z Lisieux</p>

<p><strong>â€JeÅ›li chcesz nawrÃ³ciÄ‡ grzesznika, odmÃ³w za niego rÃ³Å¼aniec.â€</strong><br>
â€” Å›w. Jan Maria Vianney</p>

<p><strong>â€Gdy mÃ³wisz rÃ³Å¼aniec, Maryja jest tuÅ¼ obok ciebie.â€</strong><br>
â€” Å›w. Alfons Maria Liguori</p>

<hr style="margin:10px 0;opacity:0.5;">

<p>RÃ³Å¼aniec jest modlitwÄ… peÅ‚nÄ… obietnic. Maryja obiecuje pomoc, ochronÄ™, pokÃ³j i Å‚aski tym, ktÃ³rzy trwajÄ… z NiÄ… na modlitwie.
Ale pamiÄ™taj â€” kaÅ¼da modlitwa ma w sobie wartoÅ›Ä‡ ofiary.</p>

<p>To nie jest wygodne siedzenie â€” to dar z siebie.  
Gdy klÄ™kasz z rÃ³Å¼aÅ„cem, gdy bolÄ… kolana albo plecy â€” wÅ‚aÅ›nie wtedy modlitwa nabiera mocy.  
Wtedy oddajesz coÅ› z siebie Bogu.  
Bo jeÅ›li prosisz Go o Å‚askÄ™, pokaÅ¼ Mu, Å¼e chcesz w niej uczestniczyÄ‡ caÅ‚ym sercem i ciaÅ‚em.</p>

<p><em>Nie musisz mieÄ‡ wielkiej wiary, Å¼eby zaczÄ…Ä‡ â€“ zacznij, by wiara mogÅ‚a w tobie wzrosnÄ…Ä‡.  
Nie musisz mieÄ‡ siÅ‚y, Å¼eby wytrwaÄ‡ â€“ weÅº rÃ³Å¼aniec, a siÅ‚a przyjdzie sama.  
Nie musisz byÄ‡ Å›wiÄ™ty, Å¼eby siÄ™ modliÄ‡ â€“ ale modlitwa moÅ¼e ciÄ™ uczyniÄ‡ Å›wiÄ™tym.</em></p>

<p><strong>SprÃ³buj choÄ‡ dziesiÄ…tkÄ™. To jak otwarcie maÅ‚ego okna â€” a przez nie wejdzie Å›wiatÅ‚o.</strong></p>`;
      nextBtn.classList.add('hide');
      finishBtn.classList.add('hide');
      if(bar) bar.style.width='100%';
      return;
    }
    
    let d=CONTENT[currentPart];
    if(!d){ currentPart='radosne'; d=CONTENT[currentPart]; }

    const max=totalSteps();
    let title,body;
    if(step===0){ title=d.intro.title; body=d.intro.body; }
    else if(step===max-1){ title=d.outro.title; body=d.outro.body; }
    else { const it=d.items[step-1]; title=it.title; body=it.body + (it.hint? ' '+HINT : ''); }

    stepTitle.textContent=title;
    stepBody.innerHTML=body;

    // zapis postÄ™pu + pasek
    saveStep(currentPart, step);
    if(bar){ const pct=Math.round((step/(max-1))*100); bar.style.width=pct+'%'; }

    nextBtn.classList.toggle('hide', step===max-1);
    finishBtn.classList.toggle('hide', step!==max-1);
  }

  // ===== Zdarzenia =====
  function setActiveChip(){ document.querySelectorAll('.chip').forEach(x=>x.classList.toggle('active', x.dataset.part===currentPart)); }

  chips.addEventListener('click',e=>{ const c=e.target.closest('.chip'); if(!c) return; currentPart=c.dataset.part; rememberPart(currentPart); step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart); setActiveChip(); });
  chips.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){ const c=e.target.closest('.chip'); if(!c) return; currentPart=c.dataset.part; rememberPart(currentPart); step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart); setActiveChip(); e.preventDefault(); }});

applyToday.addEventListener('click',()=>{
  const t = todays();
  currentPart = t.part;
  rememberPart(currentPart);
  step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart);
  setActiveChip();
  introMode = false;
  promisesMode = false;  // â¬…ï¸ DODAJ TO
  endMode = false;
  showStart();
});


startBtn.addEventListener('click',()=>{
  introMode=false;
  promisesMode=false;
  endMode=false;

  introBtn.classList.remove('active');
  promisesBtn.classList.remove('active');
  endBtn.classList.remove('active');

  if(!currentPart){
    const last=localStorage.getItem(S.lastPart);
    if(last && PARTS.includes(last)) currentPart=last;
    else currentPart=todays().part;
  }

  step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart);
  rememberPart(currentPart);

  showRead();
  renderStep();
});


introBtn.addEventListener('click',()=>{
  introMode=true;
  promisesMode=false;
  endMode=false;

  introBtn.classList.add('active');
  promisesBtn.classList.remove('active');
  endBtn.classList.remove('active');

  showRead();
  renderStep();
});


// ğŸ”µ ğŸ”µ ğŸ”µ TU WKLEJASZ TEN NOWY KAWAÅEK ğŸ”µ ğŸ”µ ğŸ”µ
promisesBtn.addEventListener('click',()=>{
  promisesMode=true;
  introMode=false;
  endMode=false;

  promisesBtn.classList.add('active');
  introBtn.classList.remove('active');
  endBtn.classList.remove('active');

  showRead();
  renderStep();
});
// ğŸ”µ ğŸ”µ ğŸ”µ KONIEC WSTAWKI ğŸ”µ ğŸ”µ ğŸ”µ
endBtn.addEventListener('click',()=>{
  endMode=true;
  introMode=false;
  promisesMode=false;

  endBtn.classList.add('active');
  introBtn.classList.remove('active');
  promisesBtn.classList.remove('active');

  showRead();
  renderStep();
});

prevBtn.addEventListener('click',()=>{

  // powrÃ³t z kaÅ¼dego trybu specjalnego
  if(introMode || promisesMode || endMode){
    introMode=false;
    promisesMode=false;
    endMode=false;
    showStart();
    return;
  }

  // klasyczne cofniÄ™cie
  if(step===0){
    showStart();
    return;
  }

  step = Math.max(0, step-1);
  renderStep();
});
  nextBtn.addEventListener('click',()=>{ step=Math.min(totalSteps()-1,step+1); renderStep(); });
  finishBtn.addEventListener('click',()=>{ setDone(currentPart,true); step=totalSteps()-1; saveStep(currentPart, step); rememberPart(currentPart); showStart(); setActiveChip(); });

  // ===== Inicjalizacja =====
  document.documentElement.classList.add('dark');
  resetIfNewDay();
  const last=localStorage.getItem(S.lastPart);
  currentPart = PARTS.includes(last)? last : todays().part;
  step = isDone(currentPart) ? totalSteps()-1 : savedStep(currentPart);
  setActiveChip();
})();
</script>
</body>
</html>
